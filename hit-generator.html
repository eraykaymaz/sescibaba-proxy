<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Hit Generator â€“ Otomatik ÃœrÃ¼n Ã‡ekme</title>

<style>
    body { background:#111; color:#fff; font-family:Arial; padding:20px; }
    h1 { text-align:center; color:#ff3366; margin-bottom:25px; }
    table { width:100%; border-collapse: collapse; background:#1b1b1b; font-size:14px; }
    th, td { padding:10px; border:1px solid #333; }
    th { background:#222; font-weight:bold; }
    input { width:100%; padding:6px; border:none; border-radius:4px; background:#2a2a2a; color:#fff; }
</style>
</head>
<body>

<h1>ðŸ”¥ Hit Generator â€“ Otomatik ÃœrÃ¼n Ã‡ekme</h1>

<p><b>HTML Proxy:</b> https://test.eray-kaymaz.workers.dev/?url=</p>

<table>
<thead>
<tr>
    <th>#</th>
    <th>ÃœrÃ¼n Linki</th>
    <th>ÃœrÃ¼n AdÄ±</th>
    <th>Resim URL</th>
    <th>Fiyat</th>
</tr>
</thead>
<tbody>

<script>
const proxy = "https://test.eray-kaymaz.workers.dev/?url=";

// 111 satÄ±r oluÅŸtur
for (let i = 1; i <= 111; i++) {
    document.write(`
    <tr>
        <td>${i}</td>
        <td><input id="link${i}" placeholder="ÃœrÃ¼n linki"
            onblur="fetchProduct(${i})"></td>
        <td><input id="title${i}"></td>
        <td><input id="img${i}"></td>
        <td><input id="price${i}"></td>
    </tr>
    `);
}

async function fetchProduct(row) {
    let link = document.getElementById("link"+row).value.trim();
    let titleInput = document.getElementById("title"+row);
    let imgInput = document.getElementById("img"+row);
    let priceInput = document.getElementById("price"+row);

    if (!link) return;

    titleInput.value = "YÃ¼kleniyor...";
    imgInput.value   = "YÃ¼kleniyor...";
    priceInput.value = "YÃ¼kleniyor...";

    try {
        // HTML Workerâ€™dan Ã§ek
        let htmlRes = await fetch(proxy + encodeURIComponent(link));
        let htmlText = await htmlRes.text();

        let parser = new DOMParser();
        let doc = parser.parseFromString(htmlText, "text/html");

        // ÃœrÃ¼n adÄ±
        let title = doc.querySelector("#product-title")?.innerText?.trim();
        titleInput.value = title || "BulunamadÄ±";

        // GÃ¶rsel
        let img = doc.querySelector(".image-inner img")?.src;
        imgInput.value = img || "BulunamadÄ±";

        // ÃœrÃ¼n kodu
        let sku = doc.querySelector("#supplier-product-code")?.innerText?.trim();
        if (!sku) {
            priceInput.value = "SKU yok";
            return;
        }

        // FÄ°YAT â†’ TARAYICIDAN Ã‡EK (CORS serbest)
        let priceAPI = `https://www.sescibaba.com/srv/service/product/price/${sku}`;
        let priceRes = await fetch(priceAPI);
        let priceJSON = await priceRes.json();

        let price = priceJSON.PRICE || "BulunamadÄ±";

        priceInput.value = price + " TL";

    } catch(e) {
        titleInput.value = "Hata";
        imgInput.value   = "Hata";
        priceInput.value = "Hata";
    }
}
</script>

</tbody>
</table>

</body>
</html>
