<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Hit Generator â€“ 111 Kategori Ä°Ã§in Otomatik ÃœrÃ¼n Ã‡ekme</title>

<style>
    body {
        background:#111;
        color:#fff;
        font-family: Arial;
        padding:20px;
    }
    h1 {
        text-align:center;
        color:#ff3366;
        margin-bottom:25px;
    }
    table {
        width:100%;
        border-collapse: collapse;
        background:#1b1b1b;
        font-size:14px;
    }
    th, td {
        padding:10px;
        border:1px solid #333;
    }
    th {
        background:#222;
        font-weight:bold;
    }
    input {
        width:100%;
        padding:6px;
        border:none;
        border-radius:4px;
        background:#2a2a2a;
        color:#fff;
    }
</style>
</head>
<body>

<h1>ðŸ”¥ Hit Generator â€“ 111 Kategori Ä°Ã§in Otomatik ÃœrÃ¼n Ã‡ekme</h1>

<p><b>Backend:</b> Cloudflare Worker Proxy  
<br>ðŸ”— <span style="color:#0f0">https://test.eray-kaymaz.workers.dev/?url=</span></p>

<table>
<thead>
<tr>
    <th>#</th>
    <th>ÃœrÃ¼n Linki</th>
    <th>ÃœrÃ¼n AdÄ± (Auto)</th>
    <th>Resim URL (Auto)</th>
    <th>Fiyat (Auto)</th>
</tr>
</thead>

<tbody id="rows">

<script>
let totalRows = 111;
let proxy = "https://test.eray-kaymaz.workers.dev/?url=";

// ðŸ‘‰ 111 SATIR OLUÅžTUR
for (let i = 1; i <= totalRows; i++) {
    document.write(`
        <tr>
            <td>${i}</td>
            <td><input id="link${i}" placeholder="ÃœrÃ¼n linki" onblur="fetchProduct(${i})"></td>
            <td><input id="title${i}" placeholder="ÃœrÃ¼n adÄ±"></td>
            <td><input id="img${i}" placeholder="GÃ¶rsel URL"></td>
            <td><input id="price${i}" placeholder="Fiyat"></td>
        </tr>
    `);
}


// âœ” URL'den HTML Ã‡EK
async function fetchProduct(row) {
    let link = document.getElementById("link"+row).value.trim();
    if (!link) return;

    let titleInput = document.getElementById("title"+row);
    let imgInput   = document.getElementById("img"+row);
    let priceInput = document.getElementById("price"+row);

    titleInput.value = "YÃ¼kleniyor...";
    imgInput.value   = "YÃ¼kleniyor...";
    priceInput.value = "YÃ¼kleniyor...";

    try {
        // HTML Ã‡EK
        let htmlRes = await fetch(proxy + encodeURIComponent(link));
        let htmlText = await htmlRes.text();

        // DOM PARSE
        let parser = new DOMParser();
        let doc = parser.parseFromString(htmlText, "text/html");

        // âœ” ÃœRÃœN BAÅžLIÄžI
        let title = doc.querySelector("#product-title")?.innerText?.trim();
        if (!title) title = "BulunamadÄ±";
        titleInput.value = title;

        // âœ” ÃœRÃœN GÃ–RSELÄ°
        let img = doc.querySelector(".image-inner img")?.src;
        if (!img) img = "BulunamadÄ±";
        imgInput.value = img;

        // âœ” ÃœRÃœN KODU â†’ FÄ°YAT API
        let sku = doc.querySelector("#supplier-product-code")?.innerText?.trim();
        if (!sku) {
            priceInput.value = "Kod Yok";
            return;
        }

        // FÄ°YAT APIâ€™DEN Ã‡EK
        let priceAPI = `https://www.sescibaba.com/srv/service/product/price/${sku}`;

        let apiRes = await fetch(proxy + encodeURIComponent(priceAPI));
        let apiText = await apiRes.text();

        let priceJSON = {};
        try {
            priceJSON = JSON.parse(apiText);
        } catch(e) {}

        let price = priceJSON.PRICE || "BulunamadÄ±";

        priceInput.value = price + " TL";

    } catch (err) {
        titleInput.value = "Hata!";
        imgInput.value   = "Hata!";
        priceInput.value = "Hata!";
    }
}

</script>

</tbody>
</table>

</body>
</html>
